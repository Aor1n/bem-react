# Bem React

Набор утилит для разработки пользовательских интерфейсов по [БЭМ-методологии](https://ru.bem.info) на [React](https://github.com/facebook/react). Bem React поддерживает аннотации типов TypeScript и Flow.

## Описание концепции

Основая мысль — работаем через полную композицию. Работу с CSS-классами и модификаторы выражаем через HOCи, а переопределение кода по платформам и экспериментам через DI.

Необходимое от BEM в React:
- декларативное разделение кода(по модификаторам, по платформам, по экспериментам);
- работа с CSS-классами.

Состав пакетов:
- `@bem-react/core`
    - `withBemClassName(cn, mapPropsToBemMod)(Component)`
    - `withBemMod(cn, predicate, HOC)(Component)`
    - `withBemClassMix(...className)(Component)`
- `@bem-react/classname`
    - `cn(block, elem?): { mods(object?): string; toString(): string; }`
- `@bem-react/di`
    - `Registry`: `Map<string, React.ComponentType>`
    - `withRegistry(registry)(Component)`

Модификатор(`withBemMod`) более не сможет влиять на внутреннее устройство компонента. Дополнительная функциональность должна быть выражена через управляющие компоненты сверху. А сами компоненты могут быть выражены как `React.ComponentType` по необходимости без каких-любо базовых BEM-компонентов. Подключение модификаторов не отличается от подключения любых других HOC и работает через любой compose.

Работа с CSS-классами состоит из 3x этапов:
- статическое создание базового CSS-класса сущности;
- динамическое добавление CSS-классов модификаторов;
- динамическое добавление CSS-классов миксов.

Статическое создание CSS-классов выражается через функцию-хелпер(`@bem-react/classname`) и HOС(`withBemClassName`), который автотматически спровайдит сгенерированный класс в пропс `className`.

Динамическое добавление CSS-классов выражается через HOC(`withBemMod`) модификатора с единственным требованием к внешнему интерфейсу компонента в виде опционального пропса `className`. Модификатор определит истинность предиката и добросит дополнительный класс через пропсы к базовому классу через ту же функцию-хелпер, что используется и для статических CSS-классов. Миксы(`withBemMix`) работают ровно так же, за тем лишь исключением, что не имеют зависимости на предикат, а добавляют CSS-класс безусловно.

Переопределение компонентов и их составляющих выражается через DI(`@bem-react/di`), который реализуется на базе [`React.ContextAPI`](https://reactjs.org/docs/context.html) и множественных реестров(`Registry`) компонентов. В данном случае, каждый компонент волен регистрировать свои зависимости в реестре и позволять переопределять их сверху, что напрямую не заложено в работу контекста, но реализуется способом резолвинга во время провайдинга нового значения контекста. По-умолчанию, зависимости возможно переопределять и по контексту вниз, что есть стандартный механизм работы контекста. В итоге, DI это HOC, который провайдит реестры в контекст. Реестры могут работать в режимах проваливания и всплытия зависимостей. Это позволяет переопределять что угодно, где угодно, на любом уровне вложенности, простым дописыванием в нужный реестр.

## Внести вклад

Bem React Core является библиотекой с открытым исходным кодом, которая находится в стадии активной разработки, а также используется внутри компании [Яндекс](https://yandex.ru/company/).

Если у вас есть предложения по улучшению API, вы можете прислать [Pull Request](https://github.com/bem/bem-react-core/pulls).

Если вы нашли ошибку, вы можете создать [issue](https://github.com/bem/bem-react-core/issues) с описанием проблемы.

Подробное руководство по внесению изменений см. в [CONTRIBUTING.md](CONTRIBUTING.md).

## Дополнительные материалы для изучения

### Видео
* [Мастер-класс по bem-react-core](https://www.youtube.com/watch?v=o1MeyEvpDTg&t)

## Лицензия

© 2018 [Яндекс](https://yandex.ru/company/). Код выпущен под [Mozilla Public License 2.0](LICENSE.txt).
